<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Stlc</span><span class="hs-operator">.</span><span class="hs-identifier">Gentzen</span><span>
</span><a name="line-2"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Stlc.Gentzen.html#gentzendiagram"><span class="hs-identifier hs-var">gentzendiagram</span></a><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#showProofTree"><span class="hs-identifier hs-var">showProofTree</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-5"></a><span class="hs-keyword">where</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><a href="Stlc.Types.html"><span class="hs-identifier">Stlc</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="Stlc.Block.html"><span class="hs-identifier">Stlc</span><span class="hs-operator">.</span><span class="hs-identifier">Block</span></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="Lambda.html"><span class="hs-identifier">Lambda</span></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="NamedLambda.html"><span class="hs-identifier">NamedLambda</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Bifunctor</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">data</span><span> </span><a name="ProofTree"><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier">ProofTree</span></a></a><span> </span><a name="local-6989586621679031897"><a href="#local-6989586621679031897"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679031898"><a href="#local-6989586621679031898"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Inference"><a href="Stlc.Gentzen.html#Inference"><span class="hs-identifier">Inference</span></a></a><span> </span><a href="#local-6989586621679031897"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Deduction"><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier">Deduction</span></a></a><span> </span><a href="#local-6989586621679031897"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679031898"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-special">[</span><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier hs-type">ProofTree</span></a><span> </span><a href="#local-6989586621679031897"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679031898"><span class="hs-identifier hs-type">l</span></a><span class="hs-special">]</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Bifunctor</span><span> </span><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier hs-type">ProofTree</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>  </span><a name="local-8214565720323806716"><span class="hs-identifier">bimap</span></a><span> </span><a name="local-6989586621679032087"><a href="#local-6989586621679032087"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Stlc.Gentzen.html#Inference"><span class="hs-identifier hs-var">Inference</span></a><span> </span><a name="local-6989586621679032088"><a href="#local-6989586621679032088"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Gentzen.html#Inference"><span class="hs-identifier hs-var">Inference</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032087"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032088"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>  </span><span class="hs-identifier">bimap</span><span> </span><a name="local-6989586621679032089"><a href="#local-6989586621679032089"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679032090"><a href="#local-6989586621679032090"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><a name="local-6989586621679032091"><a href="#local-6989586621679032091"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679032092"><a href="#local-6989586621679032092"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679032093"><a href="#local-6989586621679032093"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032089"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032091"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032090"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679032092"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bimap</span><span> </span><a href="#local-6989586621679032089"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679032090"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032093"><span class="hs-identifier hs-var">ps</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-identifier">proofBlock</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier hs-type">ProofTree</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Block.html#Block"><span class="hs-identifier hs-type">Block</span></a><span>
</span><a name="line-22"></a><a name="proofBlock"><a href="Stlc.Gentzen.html#proofBlock"><span class="hs-identifier">proofBlock</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Gentzen.html#Inference"><span class="hs-identifier hs-var">Inference</span></a><span> </span><a name="local-6989586621679031899"><a href="#local-6989586621679031899"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Block.html#textBlock"><span class="hs-identifier hs-var">textBlock</span></a><span> </span><a href="#local-6989586621679031899"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-23"></a><span class="hs-identifier">proofBlock</span><span> </span><span class="hs-special">(</span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><a name="local-6989586621679031900"><a href="#local-6989586621679031900"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679031901"><a href="#local-6989586621679031901"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679031902"><a href="#local-6989586621679031902"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Block.html#deductionBlock"><span class="hs-identifier hs-var">deductionBlock</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Block.html#textBlock"><span class="hs-identifier hs-var">textBlock</span></a><span> </span><a href="#local-6989586621679031900"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031901"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="Stlc.Gentzen.html#proofBlock"><span class="hs-identifier hs-var">proofBlock</span></a><span> </span><a href="#local-6989586621679031902"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- | Draws a complete derivation tree</span><span>
</span><a name="line-26"></a><span class="hs-identifier">showProofTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier hs-type">ProofTree</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-27"></a><a name="showProofTree"><a href="Stlc.Gentzen.html#showProofTree"><span class="hs-identifier">showProofTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Stlc.Block.html#box"><span class="hs-identifier hs-var">box</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Stlc.Gentzen.html#proofBlock"><span class="hs-identifier hs-var">proofBlock</span></a><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">data</span><span> </span><a name="Label"><a href="Stlc.Gentzen.html#Label"><span class="hs-identifier">Label</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Lponens"><a href="Stlc.Gentzen.html#Lponens"><span class="hs-identifier">Lponens</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Labs"><a href="Stlc.Gentzen.html#Labs"><span class="hs-identifier">Labs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lpair"><a href="Stlc.Gentzen.html#Lpair"><span class="hs-identifier">Lpair</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lpi1"><a href="Stlc.Gentzen.html#Lpi1"><span class="hs-identifier">Lpi1</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lpi2"><a href="Stlc.Gentzen.html#Lpi2"><span class="hs-identifier">Lpi2</span></a></a><span>
</span><a name="line-31"></a><span>           </span><span class="hs-glyph">|</span><span> </span><a name="Linr"><a href="Stlc.Gentzen.html#Linr"><span class="hs-identifier">Linr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Linl"><a href="Stlc.Gentzen.html#Linl"><span class="hs-identifier">Linl</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lcase"><a href="Stlc.Gentzen.html#Lcase"><span class="hs-identifier">Lcase</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Lunit"><a href="Stlc.Gentzen.html#Lunit"><span class="hs-identifier">Lunit</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Labort"><a href="Stlc.Gentzen.html#Labort"><span class="hs-identifier">Labort</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Labsurd"><a href="Stlc.Gentzen.html#Labsurd"><span class="hs-identifier">Labsurd</span></a></a><span>
</span><a name="line-32"></a><span>           </span><span>
</span><a name="line-33"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Stlc.Gentzen.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-34"></a><span>  </span><a name="local-8214565720323784720"><span class="hs-identifier">show</span></a><span> </span><a href="Stlc.Gentzen.html#Lponens"><span class="hs-identifier hs-var">Lponens</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#8594;)&quot;</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Labs"><span class="hs-identifier hs-var">Labs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#955;)&quot;</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Lpair"><span class="hs-identifier hs-var">Lpair</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(,)&quot;</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Lpi1"><span class="hs-identifier hs-var">Lpi1</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#960;&#8321;)&quot;</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Lpi2"><span class="hs-identifier hs-var">Lpi2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#960;&#8322;)&quot;</span><span>
</span><a name="line-39"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Linl"><span class="hs-identifier hs-var">Linl</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#953;nl)&quot;</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Linr"><span class="hs-identifier hs-var">Linr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#953;nr)&quot;</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Lcase"><span class="hs-identifier hs-var">Lcase</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(Case)&quot;</span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Lunit"><span class="hs-identifier hs-var">Lunit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#9733;)&quot;</span><span>
</span><a name="line-43"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Labort"><span class="hs-identifier hs-var">Labort</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#9633;)&quot;</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Gentzen.html#Labsurd"><span class="hs-identifier hs-var">Labsurd</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#9632;)&quot;</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-keyword">type</span><span> </span><a name="Depth"><a href="Stlc.Gentzen.html#Depth"><span class="hs-identifier">Depth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-47"></a><span class="hs-keyword">type</span><span> </span><a name="TermDiagram"><a href="Stlc.Gentzen.html#TermDiagram"><span class="hs-identifier">TermDiagram</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">,</span><a href="Stlc.Gentzen.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span class="hs-special">,</span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">-- | Gets a type derivation diagram of the term.</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- It fails if the term is non-typeable.</span><span>
</span><a name="line-52"></a><span class="hs-identifier">gentzendiagram</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier hs-type">ProofTree</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><a name="gentzendiagram"><a href="Stlc.Gentzen.html#gentzendiagram"><span class="hs-identifier">gentzendiagram</span></a></a><span> </span><a name="local-6989586621679031903"><a href="#local-6989586621679031903"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-54"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679031909"><a href="#local-6989586621679031909"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="Stlc.Types.html#variables"><span class="hs-identifier hs-var">variables</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="Stlc.Types.html#emptyctx"><span class="hs-identifier hs-var">emptyctx</span></a><span> </span><a href="#local-6989586621679031903"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>  </span><a name="local-6989586621679031910"><a href="#local-6989586621679031910"><span class="hs-identifier">maintype</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="Stlc.Types.html#variables"><span class="hs-identifier hs-var">variables</span></a><span> </span><a href="Stlc.Types.html#emptyctx"><span class="hs-identifier hs-var">emptyctx</span></a><span> </span><a href="#local-6989586621679031903"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031911"><a href="#local-6989586621679031911"><span class="hs-identifier">normtemplate</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679031910"><span class="hs-identifier hs-var">maintype</span></a><span>
</span><a name="line-57"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bimap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031904"><span class="hs-identifier hs-var">showTermDiagram</span></a><span> </span><a href="#local-6989586621679031911"><span class="hs-identifier hs-var">normtemplate</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679031909"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-59"></a><span>    </span><a name="local-6989586621679031904"><a href="#local-6989586621679031904"><span class="hs-identifier">showTermDiagram</span></a></a><span> </span><a name="local-6989586621679031905"><a href="#local-6989586621679031905"><span class="hs-identifier">normtemplate</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679031906"><a href="#local-6989586621679031906"><span class="hs-identifier">expl</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031907"><a href="#local-6989586621679031907"><span class="hs-identifier">depth</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031908"><a href="#local-6989586621679031908"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-60"></a><span>      </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="NamedLambda.html#quicknameIndexes"><span class="hs-identifier hs-var">quicknameIndexes</span></a><span> </span><a href="#local-6989586621679031907"><span class="hs-identifier hs-var">depth</span></a><span> </span><a href="NamedLambda.html#variableNames"><span class="hs-identifier hs-var">variableNames</span></a><span> </span><a href="#local-6989586621679031906"><span class="hs-identifier hs-var">expl</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-61"></a><span>      </span><span class="hs-string">&quot; &#8759; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-62"></a><span>      </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679031905"><span class="hs-identifier hs-var">normtemplate</span></a><span> </span><a href="#local-6989586621679031908"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Type inference algorithm. Infers a type from a given context and expression</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- with a set of constraints represented by a unifier type. The result type must</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- be unifiable with this given type.</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- Generalized version.</span><span>
</span><a name="line-68"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of fresh variables</span><span>
</span><a name="line-69"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Gentzen.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span>       </span><span class="hs-comment">-- ^ Lambda abstraction depth</span><span>
</span><a name="line-70"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>     </span><span class="hs-comment">-- ^ Type context</span><span>
</span><a name="line-71"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>         </span><span class="hs-comment">-- ^ Lambda expression whose type has to be inferred</span><span>
</span><a name="line-72"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>        </span><span class="hs-comment">-- ^ Constraint</span><span>
</span><a name="line-73"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#ProofTree"><span class="hs-identifier hs-type">ProofTree</span></a><span> </span><a href="Stlc.Gentzen.html#TermDiagram"><span class="hs-identifier hs-type">TermDiagram</span></a><span> </span><a href="Stlc.Gentzen.html#Label"><span class="hs-identifier hs-type">Label</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>          </span><span>
</span><a name="line-75"></a><a name="typeinfer%27"><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier">typeinfer'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-76"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679031912"><a href="#local-6989586621679031912"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679031913"><a href="#local-6989586621679031913"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679031914"><a href="#local-6989586621679031914"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679031915"><a href="#local-6989586621679031915"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031916"><a href="#local-6989586621679031916"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-79"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">member</span><span> </span><a href="#local-6989586621679031915"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679031913"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-80"></a><span>       </span><a name="local-6989586621679031917"><a href="#local-6989586621679031917"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679031915"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679031913"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-81"></a><span>       </span><a name="local-6989586621679031918"><a href="#local-6989586621679031918"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679031917"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679031916"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-82"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031918"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Inference"><span class="hs-identifier hs-var">Inference</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031914"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031912"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031918"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679031916"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031919"><a href="#local-6989586621679031919"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031920"><a href="#local-6989586621679031920"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031921"><a href="#local-6989586621679031921"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679031922"><a href="#local-6989586621679031922"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679031923"><a href="#local-6989586621679031923"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679031924"><a href="#local-6989586621679031924"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679031925"><a href="#local-6989586621679031925"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031926"><a href="#local-6989586621679031926"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031934"><a href="#local-6989586621679031934"><span class="hs-identifier">sigma</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031935"><a href="#local-6989586621679031935"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031928"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679031920"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031921"><span class="hs-identifier hs-var">depth</span></a><span> </span><a href="#local-6989586621679031922"><span class="hs-identifier hs-var">ctx</span></a><span>                  </span><a href="#local-6989586621679031924"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031919"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031926"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031936"><a href="#local-6989586621679031936"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span>   </span><a name="local-6989586621679031937"><a href="#local-6989586621679031937"><span class="hs-identifier">d2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031927"><span class="hs-identifier hs-var">odds</span></a><span>  </span><a href="#local-6989586621679031920"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031921"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679031934"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679031922"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031925"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031934"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031919"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031938"><a href="#local-6989586621679031938"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031936"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031934"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-89"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031939"><a href="#local-6989586621679031939"><span class="hs-identifier">fulld1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bimap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679031940"><a href="#local-6989586621679031940"><span class="hs-identifier">d1e</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031941"><a href="#local-6989586621679031941"><span class="hs-identifier">d1d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031942"><a href="#local-6989586621679031942"><span class="hs-identifier">d1t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031940"><span class="hs-identifier hs-var">d1e</span></a><span class="hs-special">,</span><a href="#local-6989586621679031941"><span class="hs-identifier hs-var">d1d</span></a><span class="hs-special">,</span><a href="#local-6989586621679031936"><span class="hs-identifier hs-var">tau</span></a><span> </span><a href="#local-6989586621679031942"><span class="hs-identifier hs-var">d1t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679031935"><span class="hs-identifier hs-var">d1</span></a><span>
</span><a name="line-90"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031938"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031923"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031921"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031938"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679031926"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Lponens"><span class="hs-identifier hs-var">Lponens</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031939"><span class="hs-identifier hs-var">fulld1</span></a><span class="hs-special">,</span><a href="#local-6989586621679031937"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-92"></a><span>    </span><a name="local-6989586621679031927"><a href="#local-6989586621679031927"><span class="hs-identifier">odds</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679031929"><a href="#local-6989586621679031929"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031930"><a href="#local-6989586621679031930"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031929"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031927"><span class="hs-identifier hs-var">odds</span></a><span> </span><a href="#local-6989586621679031930"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-95"></a><span>    </span><a name="local-6989586621679031928"><a href="#local-6989586621679031928"><span class="hs-identifier">evens</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679031931"><a href="#local-6989586621679031931"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031931"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031932"><a href="#local-6989586621679031932"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679031933"><a href="#local-6989586621679031933"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031932"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031928"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679031933"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031943"><a href="#local-6989586621679031943"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031944"><a href="#local-6989586621679031944"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031945"><a href="#local-6989586621679031945"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031946"><a href="#local-6989586621679031946"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679031947"><a href="#local-6989586621679031947"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679031948"><a href="#local-6989586621679031948"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679031949"><a href="#local-6989586621679031949"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031950"><a href="#local-6989586621679031950"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-101"></a><span>  </span><a name="local-6989586621679031951"><a href="#local-6989586621679031951"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679031950"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031943"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031944"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031952"><a href="#local-6989586621679031952"><span class="hs-identifier">nctx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679031951"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031951"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031943"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#incrementindices"><span class="hs-identifier hs-var">incrementindices</span></a><span> </span><a href="#local-6989586621679031947"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031953"><a href="#local-6989586621679031953"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031954"><a href="#local-6989586621679031954"><span class="hs-identifier">d2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679031945"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679031946"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031952"><span class="hs-identifier hs-var">nctx</span></a><span> </span><a href="#local-6989586621679031949"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031951"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031944"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031955"><a href="#local-6989586621679031955"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031953"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031951"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-105"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031955"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031948"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031946"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031955"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679031950"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Labs"><span class="hs-identifier hs-var">Labs</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031954"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031956"><a href="#local-6989586621679031956"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031957"><a href="#local-6989586621679031957"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031958"><a href="#local-6989586621679031958"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031959"><a href="#local-6989586621679031959"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679031960"><a href="#local-6989586621679031960"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679031961"><a href="#local-6989586621679031961"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679031962"><a href="#local-6989586621679031962"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679031963"><a href="#local-6989586621679031963"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031964"><a href="#local-6989586621679031964"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-6989586621679031972"><a href="#local-6989586621679031972"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679031964"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031956"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031957"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031973"><a href="#local-6989586621679031973"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031974"><a href="#local-6989586621679031974"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031966"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679031958"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031959"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679031972"><span class="hs-identifier hs-var">sigma</span></a><span>         </span><a href="#local-6989586621679031960"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031962"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031972"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031956"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031975"><a href="#local-6989586621679031975"><span class="hs-identifier">rho</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031976"><a href="#local-6989586621679031976"><span class="hs-identifier">d2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031965"><span class="hs-identifier hs-var">odds</span></a><span>  </span><a href="#local-6989586621679031958"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031959"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031973"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031972"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031960"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031963"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031973"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031972"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031957"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031977"><a href="#local-6989586621679031977"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031975"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031973"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679031972"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-112"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031978"><a href="#local-6989586621679031978"><span class="hs-identifier">fulld1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bimap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679031979"><a href="#local-6989586621679031979"><span class="hs-identifier">d1e</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031980"><a href="#local-6989586621679031980"><span class="hs-identifier">d1d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679031981"><a href="#local-6989586621679031981"><span class="hs-identifier">d1t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031979"><span class="hs-identifier hs-var">d1e</span></a><span class="hs-special">,</span><a href="#local-6989586621679031980"><span class="hs-identifier hs-var">d1d</span></a><span class="hs-special">,</span><a href="#local-6989586621679031975"><span class="hs-identifier hs-var">rho</span></a><span> </span><a href="#local-6989586621679031981"><span class="hs-identifier hs-var">d1t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679031974"><span class="hs-identifier hs-var">d1</span></a><span>
</span><a name="line-113"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031977"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031961"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031959"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031977"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679031964"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Lpair"><span class="hs-identifier hs-var">Lpair</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031978"><span class="hs-identifier hs-var">fulld1</span></a><span class="hs-special">,</span><a href="#local-6989586621679031976"><span class="hs-identifier hs-var">d2</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-115"></a><span>    </span><a name="local-6989586621679031965"><a href="#local-6989586621679031965"><span class="hs-identifier">odds</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-116"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679031967"><a href="#local-6989586621679031967"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031968"><a href="#local-6989586621679031968"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031967"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031965"><span class="hs-identifier hs-var">odds</span></a><span> </span><a href="#local-6989586621679031968"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-118"></a><span>    </span><a name="local-6989586621679031966"><a href="#local-6989586621679031966"><span class="hs-identifier">evens</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679031969"><a href="#local-6989586621679031969"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031969"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031970"><a href="#local-6989586621679031970"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679031971"><a href="#local-6989586621679031971"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031970"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679031966"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679031971"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031982"><a href="#local-6989586621679031982"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031983"><a href="#local-6989586621679031983"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031984"><a href="#local-6989586621679031984"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679031985"><a href="#local-6989586621679031985"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679031986"><a href="#local-6989586621679031986"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679031987"><a href="#local-6989586621679031987"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031988"><a href="#local-6989586621679031988"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031989"><a href="#local-6989586621679031989"><span class="hs-identifier">sigma</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679031990"><a href="#local-6989586621679031990"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679031983"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679031984"><span class="hs-identifier hs-var">depth</span></a><span> </span><a href="#local-6989586621679031985"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679031987"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a href="#local-6989586621679031988"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031982"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679031991"><a href="#local-6989586621679031991"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031989"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-126"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031991"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031986"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031984"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031991"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679031988"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Lpi1"><span class="hs-identifier hs-var">Lpi1</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679031990"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>  </span><span>
</span><a name="line-128"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679031992"><a href="#local-6989586621679031992"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679031993"><a href="#local-6989586621679031993"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031994"><a href="#local-6989586621679031994"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679031995"><a href="#local-6989586621679031995"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679031996"><a href="#local-6989586621679031996"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679031997"><a href="#local-6989586621679031997"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679031998"><a href="#local-6989586621679031998"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679031999"><a href="#local-6989586621679031999"><span class="hs-identifier">sigma</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032000"><a href="#local-6989586621679032000"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679031993"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679031994"><span class="hs-identifier hs-var">depth</span></a><span> </span><a href="#local-6989586621679031995"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679031997"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679031992"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679031998"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032001"><a href="#local-6989586621679032001"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679031999"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032001"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679031996"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679031994"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032001"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679031998"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Lpi2"><span class="hs-identifier hs-var">Lpi2</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032000"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032002"><a href="#local-6989586621679032002"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032003"><a href="#local-6989586621679032003"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032004"><a href="#local-6989586621679032004"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032005"><a href="#local-6989586621679032005"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679032006"><a href="#local-6989586621679032006"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679032007"><a href="#local-6989586621679032007"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679032008"><a href="#local-6989586621679032008"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032009"><a href="#local-6989586621679032009"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-134"></a><span>  </span><a name="local-6989586621679032010"><a href="#local-6989586621679032010"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679032009"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032002"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032003"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032011"><a href="#local-6989586621679032011"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032012"><a href="#local-6989586621679032012"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679032004"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679032005"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679032010"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679032006"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032008"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032010"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032002"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032013"><a href="#local-6989586621679032013"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032011"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032010"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-137"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032013"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032007"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032005"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032013"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679032009"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Linl"><span class="hs-identifier hs-var">Linl</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032012"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032014"><a href="#local-6989586621679032014"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032015"><a href="#local-6989586621679032015"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032016"><a href="#local-6989586621679032016"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032017"><a href="#local-6989586621679032017"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679032018"><a href="#local-6989586621679032018"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679032019"><a href="#local-6989586621679032019"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679032020"><a href="#local-6989586621679032020"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032021"><a href="#local-6989586621679032021"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-140"></a><span>  </span><a name="local-6989586621679032022"><a href="#local-6989586621679032022"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679032021"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032014"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032015"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032023"><a href="#local-6989586621679032023"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032024"><a href="#local-6989586621679032024"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679032016"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679032017"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679032022"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679032018"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032020"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032022"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032015"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032025"><a href="#local-6989586621679032025"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032023"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032022"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-143"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032025"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032019"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032017"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032025"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679032021"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Linr"><span class="hs-identifier hs-var">Linr</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032024"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032026"><a href="#local-6989586621679032026"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032027"><a href="#local-6989586621679032027"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032028"><a href="#local-6989586621679032028"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032029"><a href="#local-6989586621679032029"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679032030"><a href="#local-6989586621679032030"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679032031"><a href="#local-6989586621679032031"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679032032"><a href="#local-6989586621679032032"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679032033"><a href="#local-6989586621679032033"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679032034"><a href="#local-6989586621679032034"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032035"><a href="#local-6989586621679032035"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032048"><a href="#local-6989586621679032048"><span class="hs-identifier">sigma</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032049"><a href="#local-6989586621679032049"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032036"><span class="hs-identifier hs-var">third1</span></a><span> </span><a href="#local-6989586621679032028"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032029"><span class="hs-identifier hs-var">depth</span></a><span> </span><a href="#local-6989586621679032030"><span class="hs-identifier hs-var">ctx</span></a><span>                          </span><a href="#local-6989586621679032033"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032026"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032035"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032050"><a href="#local-6989586621679032050"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span>   </span><a name="local-6989586621679032051"><a href="#local-6989586621679032051"><span class="hs-identifier">d2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032037"><span class="hs-identifier hs-var">third2</span></a><span> </span><a href="#local-6989586621679032028"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032029"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679032030"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span>         </span><a href="#local-6989586621679032034"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032027"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679032035"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032052"><a href="#local-6989586621679032052"><span class="hs-identifier">rho</span></a></a><span class="hs-special">,</span><span>   </span><a name="local-6989586621679032053"><a href="#local-6989586621679032053"><span class="hs-identifier">d3</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032038"><span class="hs-identifier hs-var">third3</span></a><span> </span><a href="#local-6989586621679032028"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032029"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032050"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032030"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032032"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032050"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032026"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032050"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679032027"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032054"><a href="#local-6989586621679032054"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032052"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032050"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032048"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-150"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032055"><a href="#local-6989586621679032055"><span class="hs-identifier">fulld1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bimap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679032056"><a href="#local-6989586621679032056"><span class="hs-identifier">d1e</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032057"><a href="#local-6989586621679032057"><span class="hs-identifier">d1d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032058"><a href="#local-6989586621679032058"><span class="hs-identifier">d1t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032056"><span class="hs-identifier hs-var">d1e</span></a><span class="hs-special">,</span><a href="#local-6989586621679032057"><span class="hs-identifier hs-var">d1d</span></a><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679032052"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032050"><span class="hs-identifier hs-var">tau</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032058"><span class="hs-identifier hs-var">d1t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679032049"><span class="hs-identifier hs-var">d1</span></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032059"><a href="#local-6989586621679032059"><span class="hs-identifier">fulld2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">bimap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679032060"><a href="#local-6989586621679032060"><span class="hs-identifier">d2e</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032061"><a href="#local-6989586621679032061"><span class="hs-identifier">d2d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679032062"><a href="#local-6989586621679032062"><span class="hs-identifier">d2t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032060"><span class="hs-identifier hs-var">d2e</span></a><span class="hs-special">,</span><a href="#local-6989586621679032061"><span class="hs-identifier hs-var">d2d</span></a><span class="hs-special">,</span><a href="#local-6989586621679032052"><span class="hs-identifier hs-var">rho</span></a><span> </span><a href="#local-6989586621679032062"><span class="hs-identifier hs-var">d2t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><a href="#local-6989586621679032051"><span class="hs-identifier hs-var">d2</span></a><span>
</span><a name="line-152"></a><span>  </span><span class="hs-comment">-- Pruning the tree to make it match the natural deduction case rule</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679032055"><span class="hs-identifier hs-var">fulld1</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-154"></a><span>    </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Gentzen.html#Labs"><span class="hs-identifier hs-var">Labs</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679032063"><a href="#local-6989586621679032063"><span class="hs-identifier">reald1</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-155"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679032059"><span class="hs-identifier hs-var">fulld2</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-156"></a><span>        </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Gentzen.html#Labs"><span class="hs-identifier hs-var">Labs</span></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679032064"><a href="#local-6989586621679032064"><span class="hs-identifier">reald2</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032054"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032031"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032029"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032054"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679032035"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Lcase"><span class="hs-identifier hs-var">Lcase</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032063"><span class="hs-identifier hs-var">reald1</span></a><span class="hs-special">,</span><a href="#local-6989586621679032064"><span class="hs-identifier hs-var">reald2</span></a><span class="hs-special">,</span><a href="#local-6989586621679032053"><span class="hs-identifier hs-var">d3</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-159"></a><span>    </span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-161"></a><span>    </span><a name="local-6989586621679032036"><a href="#local-6989586621679032036"><span class="hs-identifier">third1</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-identifier">third1</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier">third1</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier">third1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679032039"><a href="#local-6989586621679032039"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679032040"><a href="#local-6989586621679032040"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032039"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679032036"><span class="hs-identifier hs-var">third1</span></a><span> </span><a href="#local-6989586621679032040"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-165"></a><span>    </span><a name="local-6989586621679032037"><a href="#local-6989586621679032037"><span class="hs-identifier">third2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-identifier">third2</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-identifier">third2</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679032041"><a href="#local-6989586621679032041"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032041"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-identifier">third2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679032042"><a href="#local-6989586621679032042"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679032043"><a href="#local-6989586621679032043"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032042"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679032037"><span class="hs-identifier hs-var">third2</span></a><span> </span><a href="#local-6989586621679032043"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-169"></a><span>    </span><a name="local-6989586621679032038"><a href="#local-6989586621679032038"><span class="hs-identifier">third3</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-identifier">third3</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679032044"><a href="#local-6989586621679032044"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032044"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-identifier">third3</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679032045"><a href="#local-6989586621679032045"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032045"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-identifier">third3</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679032046"><a href="#local-6989586621679032046"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679032047"><a href="#local-6989586621679032047"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032046"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679032038"><span class="hs-identifier hs-var">third3</span></a><span> </span><a href="#local-6989586621679032047"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-identifier">typeinfer'</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679032065"><a href="#local-6989586621679032065"><span class="hs-identifier">depth</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679032066"><a href="#local-6989586621679032066"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span> </span><a name="local-6989586621679032067"><a href="#local-6989586621679032067"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-175"></a><span>  </span><a name="local-6989586621679032068"><a href="#local-6989586621679032068"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><a href="#local-6989586621679032067"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-176"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032068"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032066"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032065"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032068"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679032067"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Lunit"><span class="hs-identifier hs-var">Lunit</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">typeinfer'</span><span> </span><a name="local-6989586621679032069"><a href="#local-6989586621679032069"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679032070"><a href="#local-6989586621679032070"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679032071"><a href="#local-6989586621679032071"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679032072"><a href="#local-6989586621679032072"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679032073"><a href="#local-6989586621679032073"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032074"><a href="#local-6989586621679032074"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032075"><a href="#local-6989586621679032075"><span class="hs-identifier">ss</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032076"><a href="#local-6989586621679032076"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679032069"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679032070"><span class="hs-identifier hs-var">depth</span></a><span> </span><a href="#local-6989586621679032071"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679032073"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-180"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032075"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032072"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032070"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032075"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679032074"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Labort"><span class="hs-identifier hs-var">Labort</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032076"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-identifier">typeinfer'</span><span> </span><a name="local-6989586621679032077"><a href="#local-6989586621679032077"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679032078"><a href="#local-6989586621679032078"><span class="hs-identifier">depth</span></a></a><span> </span><a name="local-6989586621679032079"><a href="#local-6989586621679032079"><span class="hs-identifier">ctx</span></a></a><span> </span><a name="local-6989586621679032080"><a href="#local-6989586621679032080"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679032081"><a href="#local-6989586621679032081"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679032082"><a href="#local-6989586621679032082"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-183"></a><span>  </span><a name="local-6989586621679032083"><a href="#local-6989586621679032083"><span class="hs-identifier">sigma</span></a></a><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><a href="#local-6989586621679032082"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-184"></a><span>  </span><span class="hs-special">(</span><a name="local-6989586621679032084"><a href="#local-6989586621679032084"><span class="hs-identifier">tau</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679032085"><a href="#local-6989586621679032085"><span class="hs-identifier">d1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Gentzen.html#typeinfer%27"><span class="hs-identifier hs-var">typeinfer'</span></a><span> </span><a href="#local-6989586621679032077"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679032078"><span class="hs-identifier hs-var">depth</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679032083"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679032079"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679032081"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-185"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679032086"><a href="#local-6989586621679032086"><span class="hs-identifier">ss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679032084"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679032083"><span class="hs-identifier hs-var">sigma</span></a><span>
</span><a name="line-186"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032086"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Gentzen.html#Deduction"><span class="hs-identifier hs-var">Deduction</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679032080"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032078"><span class="hs-identifier hs-var">depth</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679032086"><span class="hs-identifier hs-var">ss</span></a><span> </span><a href="#local-6989586621679032082"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="Stlc.Gentzen.html#Labsurd"><span class="hs-identifier hs-var">Labsurd</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679032085"><span class="hs-identifier hs-var">d1</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span>                     </span><span>
</span><a name="line-189"></a></pre></body></html>