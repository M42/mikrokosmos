<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Stlc</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-2"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span class="hs-special">)</span><span>
</span><a name="line-3"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#typeinference"><span class="hs-identifier hs-var">typeinference</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span>
</span><a name="line-6"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#emptyctx"><span class="hs-identifier hs-var">emptyctx</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#incrementindices"><span class="hs-identifier hs-var">incrementindices</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#variables"><span class="hs-identifier hs-var">variables</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-type">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Lambda.html"><span class="hs-identifier">Lambda</span></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- | A type context is a map from deBruijn indices to types. Given</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- any lambda variable as a deBruijn index, it returns its type.</span><span>
</span><a name="line-26"></a><span class="hs-keyword">type</span><span> </span><a name="Context"><a href="Stlc.Types.html#Context"><span class="hs-identifier">Context</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- | A type variable is an integer.</span><span>
</span><a name="line-29"></a><span class="hs-keyword">type</span><span> </span><a name="Variable"><a href="Stlc.Types.html#Variable"><span class="hs-identifier">Variable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- | A type substitution is a function that can be applied to any type</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- to get a new one.</span><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="Substitution"><a href="Stlc.Types.html#Substitution"><span class="hs-identifier">Substitution</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">-- | A type template is a free type variable or an arrow between two</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- types; that is, the function type.</span><span>
</span><a name="line-37"></a><span class="hs-keyword">data</span><span> </span><a name="Type"><a href="Stlc.Types.html#Type"><span class="hs-identifier">Type</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Tvar"><a href="Stlc.Types.html#Tvar"><span class="hs-identifier">Tvar</span></a></a><span> </span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span>
</span><a name="line-38"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Arrow"><a href="Stlc.Types.html#Arrow"><span class="hs-identifier">Arrow</span></a></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-39"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Times"><a href="Stlc.Types.html#Times"><span class="hs-identifier">Times</span></a></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-40"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Union"><a href="Stlc.Types.html#Union"><span class="hs-identifier">Union</span></a></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-41"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Unitty"><a href="Stlc.Types.html#Unitty"><span class="hs-identifier">Unitty</span></a></a><span>
</span><a name="line-42"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="Bottom"><a href="Stlc.Types.html#Bottom"><span class="hs-identifier">Bottom</span></a></a><span>
</span><a name="line-43"></a><span>          </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-46"></a><span>  </span><a name="local-8214565720323784720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030586"><a href="#local-6989586621679030586"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#typevariableNames"><span class="hs-identifier hs-var">typevariableNames</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679030586"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-47"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030587"><a href="#local-6989586621679030587"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030588"><a href="#local-6989586621679030588"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#showparens"><span class="hs-identifier hs-var">showparens</span></a><span> </span><a href="#local-6989586621679030587"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &#8594; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030588"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030589"><a href="#local-6989586621679030589"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030590"><a href="#local-6989586621679030590"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#showparens"><span class="hs-identifier hs-var">showparens</span></a><span> </span><a href="#local-6989586621679030589"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &#215; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparens"><span class="hs-identifier hs-var">showparens</span></a><span> </span><a href="#local-6989586621679030590"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030591"><a href="#local-6989586621679030591"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030592"><a href="#local-6989586621679030592"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#showparens"><span class="hs-identifier hs-var">showparens</span></a><span> </span><a href="#local-6989586621679030591"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; + &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparens"><span class="hs-identifier hs-var">showparens</span></a><span> </span><a href="#local-6989586621679030592"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-50"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#8868;&quot;</span><span>
</span><a name="line-51"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#8869;&quot;</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">showparens</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-54"></a><a name="showparens"><a href="Stlc.Types.html#showparens"><span class="hs-identifier">showparens</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030369"><a href="#local-6989586621679030369"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030369"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-identifier">showparens</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span>
</span><a name="line-56"></a><span class="hs-identifier">showparens</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-57"></a><span class="hs-identifier">showparens</span><span> </span><a name="local-6989586621679030370"><a href="#local-6989586621679030370"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679030370"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-58"></a><span>  </span><span>
</span><a name="line-59"></a><span class="hs-comment">-- | Creates the substitution given by the change of a variable for</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- the given type.</span><span>
</span><a name="line-61"></a><span class="hs-identifier">subs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-62"></a><a name="subs"><a href="Stlc.Types.html#subs"><span class="hs-identifier">subs</span></a></a><span> </span><a name="local-6989586621679030371"><a href="#local-6989586621679030371"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679030372"><a href="#local-6989586621679030372"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030373"><a href="#local-6989586621679030373"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679030371"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679030373"><span class="hs-identifier hs-var">y</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030372"><span class="hs-identifier hs-var">typ</span></a><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030373"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-65"></a><span class="hs-identifier">subs</span><span> </span><a name="local-6989586621679030374"><a href="#local-6989586621679030374"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679030375"><a href="#local-6989586621679030375"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030376"><a href="#local-6989586621679030376"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030377"><a href="#local-6989586621679030377"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030374"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030375"><span class="hs-identifier hs-var">typ</span></a><span> </span><a href="#local-6989586621679030376"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030374"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030375"><span class="hs-identifier hs-var">typ</span></a><span> </span><a href="#local-6989586621679030377"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-identifier">subs</span><span> </span><a name="local-6989586621679030378"><a href="#local-6989586621679030378"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679030379"><a href="#local-6989586621679030379"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030380"><a href="#local-6989586621679030380"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030381"><a href="#local-6989586621679030381"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030378"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030379"><span class="hs-identifier hs-var">typ</span></a><span> </span><a href="#local-6989586621679030380"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030378"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030379"><span class="hs-identifier hs-var">typ</span></a><span> </span><a href="#local-6989586621679030381"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-identifier">subs</span><span> </span><a name="local-6989586621679030382"><a href="#local-6989586621679030382"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679030383"><a href="#local-6989586621679030383"><span class="hs-identifier">typ</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030384"><a href="#local-6989586621679030384"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030385"><a href="#local-6989586621679030385"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030382"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030383"><span class="hs-identifier hs-var">typ</span></a><span> </span><a href="#local-6989586621679030384"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030382"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030383"><span class="hs-identifier hs-var">typ</span></a><span> </span><a href="#local-6989586621679030385"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span class="hs-identifier">subs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span>
</span><a name="line-69"></a><span class="hs-identifier">subs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Returns true if the given variable appears on the type.</span><span>
</span><a name="line-72"></a><span class="hs-identifier">occurs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-73"></a><a name="occurs"><a href="Stlc.Types.html#occurs"><span class="hs-identifier">occurs</span></a></a><span> </span><a name="local-6989586621679030386"><a href="#local-6989586621679030386"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030387"><a href="#local-6989586621679030387"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030386"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679030387"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-74"></a><span class="hs-identifier">occurs</span><span> </span><a name="local-6989586621679030388"><a href="#local-6989586621679030388"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030389"><a href="#local-6989586621679030389"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030390"><a href="#local-6989586621679030390"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030388"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030389"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030388"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030390"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-75"></a><span class="hs-identifier">occurs</span><span> </span><a name="local-6989586621679030391"><a href="#local-6989586621679030391"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030392"><a href="#local-6989586621679030392"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030393"><a href="#local-6989586621679030393"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030391"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030392"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030391"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030393"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-76"></a><span class="hs-identifier">occurs</span><span> </span><a name="local-6989586621679030394"><a href="#local-6989586621679030394"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030395"><a href="#local-6989586621679030395"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030396"><a href="#local-6989586621679030396"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030394"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030395"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030394"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030396"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-77"></a><span class="hs-identifier">occurs</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-78"></a><span class="hs-identifier">occurs</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | Unifies two types with their most general unifier. Returns the substitution</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- that transforms any of the types into the unifier.</span><span>
</span><a name="line-82"></a><span class="hs-identifier">unify</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-83"></a><a name="unify"><a href="Stlc.Types.html#unify"><span class="hs-identifier">unify</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030397"><a href="#local-6989586621679030397"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030398"><a href="#local-6989586621679030398"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679030397"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679030398"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030397"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030398"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span class="hs-identifier">unify</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030399"><a href="#local-6989586621679030399"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030400"><a href="#local-6989586621679030400"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-87"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030399"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030400"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030399"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679030400"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span class="hs-identifier">unify</span><span> </span><a name="local-6989586621679030401"><a href="#local-6989586621679030401"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030402"><a href="#local-6989586621679030402"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="Stlc.Types.html#occurs"><span class="hs-identifier hs-var">occurs</span></a><span> </span><a href="#local-6989586621679030402"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679030401"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#subs"><span class="hs-identifier hs-var">subs</span></a><span> </span><a href="#local-6989586621679030402"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679030401"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span class="hs-identifier">unify</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030403"><a href="#local-6989586621679030403"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030404"><a href="#local-6989586621679030404"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030405"><a href="#local-6989586621679030405"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679030406"><a href="#local-6989586621679030406"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#unifypair"><span class="hs-identifier hs-var">unifypair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030403"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679030404"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030405"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679030406"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span class="hs-identifier">unify</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030407"><a href="#local-6989586621679030407"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030408"><a href="#local-6989586621679030408"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030409"><a href="#local-6989586621679030409"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679030410"><a href="#local-6989586621679030410"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#unifypair"><span class="hs-identifier hs-var">unifypair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030407"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679030408"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030409"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679030410"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span class="hs-identifier">unify</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030411"><a href="#local-6989586621679030411"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030412"><a href="#local-6989586621679030412"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030413"><a href="#local-6989586621679030413"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679030414"><a href="#local-6989586621679030414"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#unifypair"><span class="hs-identifier hs-var">unifypair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030411"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030412"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030413"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030414"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span class="hs-identifier">unify</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-96"></a><span class="hs-identifier">unify</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-97"></a><span class="hs-identifier">unify</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | Unifies a pair of types</span><span>
</span><a name="line-100"></a><span class="hs-identifier">unifypair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">,</span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-101"></a><a name="unifypair"><a href="Stlc.Types.html#unifypair"><span class="hs-identifier">unifypair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679030415"><a href="#local-6989586621679030415"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679030416"><a href="#local-6989586621679030416"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030417"><a href="#local-6989586621679030417"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679030418"><a href="#local-6989586621679030418"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-102"></a><span>  </span><a name="local-6989586621679030419"><a href="#local-6989586621679030419"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679030416"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679030418"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-103"></a><span>  </span><a name="local-6989586621679030420"><a href="#local-6989586621679030420"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030419"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679030415"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030419"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679030417"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030420"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030419"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Apply a substitution to all the types on a type context.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">applyctx</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>
</span><a name="line-108"></a><a name="applyctx"><a href="Stlc.Types.html#applyctx"><span class="hs-identifier">applyctx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-comment">-- | The empty context.</span><span>
</span><a name="line-111"></a><span class="hs-identifier">emptyctx</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>
</span><a name="line-112"></a><a name="emptyctx"><a href="Stlc.Types.html#emptyctx"><span class="hs-identifier">emptyctx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Increments all the indices of a given context. It is useful for</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- adapting the context to a new scope.</span><span>
</span><a name="line-116"></a><span class="hs-identifier">incrementindices</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>
</span><a name="line-117"></a><a name="incrementindices"><a href="Stlc.Types.html#incrementindices"><span class="hs-identifier">incrementindices</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapKeys</span><span> </span><span class="hs-identifier hs-var">succ</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | Type inference algorithm. Infers a type from a given context and expression</span><span>
</span><a name="line-120"></a><span class="hs-comment">-- with a set of constraints represented by a unifier type. The result type must</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- be unifiable with this given type.</span><span>
</span><a name="line-122"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of fresh variables</span><span>
</span><a name="line-123"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Context"><span class="hs-identifier hs-type">Context</span></a><span>    </span><span class="hs-comment">-- ^ Type context</span><span>
</span><a name="line-124"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>        </span><span class="hs-comment">-- ^ Lambda expression whose type has to be inferred</span><span>
</span><a name="line-125"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>       </span><span class="hs-comment">-- ^ Constraint</span><span>
</span><a name="line-126"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Stlc.Types.html#Substitution"><span class="hs-identifier hs-type">Substitution</span></a><span>
</span><a name="line-127"></a><span>          </span><span>
</span><a name="line-128"></a><a name="typeinfer"><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier">typeinfer</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-129"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679030421"><a href="#local-6989586621679030421"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679030422"><a href="#local-6989586621679030422"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030423"><a href="#local-6989586621679030423"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-132"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">member</span><span> </span><a href="#local-6989586621679030422"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679030421"><span class="hs-identifier hs-var">ctx</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-133"></a><span>       </span><a name="local-6989586621679030424"><a href="#local-6989586621679030424"><span class="hs-identifier">var</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679030422"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679030421"><span class="hs-identifier hs-var">ctx</span></a><span>
</span><a name="line-134"></a><span>       </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679030424"><span class="hs-identifier hs-var">var</span></a><span> </span><a href="#local-6989586621679030423"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-135"></a><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030425"><a href="#local-6989586621679030425"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030426"><a href="#local-6989586621679030426"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030427"><a href="#local-6989586621679030427"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679030428"><a href="#local-6989586621679030428"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679030429"><a href="#local-6989586621679030429"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030430"><a href="#local-6989586621679030430"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-138"></a><span>  </span><a name="local-6989586621679030438"><a href="#local-6989586621679030438"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030432"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679030426"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030427"><span class="hs-identifier hs-var">ctx</span></a><span>                  </span><a href="#local-6989586621679030428"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030425"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030430"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>  </span><a name="local-6989586621679030439"><a href="#local-6989586621679030439"><span class="hs-identifier">tau</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030431"><span class="hs-identifier hs-var">odds</span></a><span>  </span><a href="#local-6989586621679030426"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030438"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679030427"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030429"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030438"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030425"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030439"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030438"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-6989586621679030431"><a href="#local-6989586621679030431"><span class="hs-identifier">odds</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-144"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030433"><a href="#local-6989586621679030433"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030434"><a href="#local-6989586621679030434"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030433"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030431"><span class="hs-identifier hs-var">odds</span></a><span> </span><a href="#local-6989586621679030434"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-145"></a><span>    </span><a name="local-6989586621679030432"><a href="#local-6989586621679030432"><span class="hs-identifier">evens</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679030435"><a href="#local-6989586621679030435"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030435"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-147"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030436"><a href="#local-6989586621679030436"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030437"><a href="#local-6989586621679030437"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030436"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030432"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679030437"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030440"><a href="#local-6989586621679030440"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030441"><a href="#local-6989586621679030441"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030442"><a href="#local-6989586621679030442"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030443"><a href="#local-6989586621679030443"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679030444"><a href="#local-6989586621679030444"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030445"><a href="#local-6989586621679030445"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-151"></a><span>  </span><a name="local-6989586621679030446"><a href="#local-6989586621679030446"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679030445"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030440"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030441"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679030447"><a href="#local-6989586621679030447"><span class="hs-identifier">nctx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030446"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030446"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030440"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#incrementindices"><span class="hs-identifier hs-var">incrementindices</span></a><span> </span><a href="#local-6989586621679030443"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>  </span><a name="local-6989586621679030448"><a href="#local-6989586621679030448"><span class="hs-identifier">tau</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030442"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679030447"><span class="hs-identifier hs-var">nctx</span></a><span> </span><a href="#local-6989586621679030444"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030446"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030441"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030448"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030446"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030449"><a href="#local-6989586621679030449"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030450"><a href="#local-6989586621679030450"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030451"><a href="#local-6989586621679030451"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030452"><a href="#local-6989586621679030452"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679030453"><a href="#local-6989586621679030453"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679030454"><a href="#local-6989586621679030454"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030455"><a href="#local-6989586621679030455"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-157"></a><span>  </span><a name="local-6989586621679030463"><a href="#local-6989586621679030463"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679030455"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030449"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030450"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>  </span><a name="local-6989586621679030464"><a href="#local-6989586621679030464"><span class="hs-identifier">tau</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030457"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679030451"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030463"><span class="hs-identifier hs-var">sigma</span></a><span>         </span><a href="#local-6989586621679030452"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030453"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030463"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030449"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>  </span><a name="local-6989586621679030465"><a href="#local-6989586621679030465"><span class="hs-identifier">rho</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030456"><span class="hs-identifier hs-var">odds</span></a><span>  </span><a href="#local-6989586621679030451"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030464"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030463"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030452"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030454"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030464"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030463"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030450"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030465"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030464"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030463"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-162"></a><span>    </span><a name="local-6989586621679030456"><a href="#local-6989586621679030456"><span class="hs-identifier">odds</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier">odds</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030458"><a href="#local-6989586621679030458"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030459"><a href="#local-6989586621679030459"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030458"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030456"><span class="hs-identifier hs-var">odds</span></a><span> </span><a href="#local-6989586621679030459"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-165"></a><span>    </span><a name="local-6989586621679030457"><a href="#local-6989586621679030457"><span class="hs-identifier">evens</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679030460"><a href="#local-6989586621679030460"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030460"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-identifier">evens</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030461"><a href="#local-6989586621679030461"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030462"><a href="#local-6989586621679030462"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030461"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030457"><span class="hs-identifier hs-var">evens</span></a><span> </span><a href="#local-6989586621679030462"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030466"><a href="#local-6989586621679030466"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030467"><a href="#local-6989586621679030467"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030468"><a href="#local-6989586621679030468"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679030469"><a href="#local-6989586621679030469"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030470"><a href="#local-6989586621679030470"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030467"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679030468"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679030469"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a href="#local-6989586621679030470"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030466"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030471"><a href="#local-6989586621679030471"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030472"><a href="#local-6989586621679030472"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030473"><a href="#local-6989586621679030473"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679030474"><a href="#local-6989586621679030474"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030475"><a href="#local-6989586621679030475"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030472"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679030473"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679030474"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030471"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030475"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030476"><a href="#local-6989586621679030476"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030477"><a href="#local-6989586621679030477"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030478"><a href="#local-6989586621679030478"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030479"><a href="#local-6989586621679030479"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679030480"><a href="#local-6989586621679030480"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030481"><a href="#local-6989586621679030481"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-174"></a><span>  </span><a name="local-6989586621679030482"><a href="#local-6989586621679030482"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679030481"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030476"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030477"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span>  </span><a name="local-6989586621679030483"><a href="#local-6989586621679030483"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030478"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030482"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679030479"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030480"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030482"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030476"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030483"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030482"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030484"><a href="#local-6989586621679030484"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030485"><a href="#local-6989586621679030485"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030486"><a href="#local-6989586621679030486"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030487"><a href="#local-6989586621679030487"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679030488"><a href="#local-6989586621679030488"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030489"><a href="#local-6989586621679030489"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-179"></a><span>  </span><a name="local-6989586621679030490"><a href="#local-6989586621679030490"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="#local-6989586621679030489"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030484"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030485"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>  </span><a name="local-6989586621679030491"><a href="#local-6989586621679030491"><span class="hs-identifier">tau</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030486"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030490"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679030487"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030488"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030490"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030485"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030491"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030490"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030492"><a href="#local-6989586621679030492"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030493"><a href="#local-6989586621679030493"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030494"><a href="#local-6989586621679030494"><span class="hs-identifier">vars</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030495"><a href="#local-6989586621679030495"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679030496"><a href="#local-6989586621679030496"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679030497"><a href="#local-6989586621679030497"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679030498"><a href="#local-6989586621679030498"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030499"><a href="#local-6989586621679030499"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-184"></a><span>  </span><a name="local-6989586621679030512"><a href="#local-6989586621679030512"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030500"><span class="hs-identifier hs-var">third1</span></a><span> </span><a href="#local-6989586621679030494"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030495"><span class="hs-identifier hs-var">ctx</span></a><span>                          </span><a href="#local-6989586621679030497"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030492"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030499"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>  </span><a name="local-6989586621679030513"><a href="#local-6989586621679030513"><span class="hs-identifier">tau</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030501"><span class="hs-identifier hs-var">third2</span></a><span> </span><a href="#local-6989586621679030494"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679030495"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span>         </span><a href="#local-6989586621679030498"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030493"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679030499"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>  </span><a name="local-6989586621679030514"><a href="#local-6989586621679030514"><span class="hs-identifier">rho</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030502"><span class="hs-identifier hs-var">third3</span></a><span> </span><a href="#local-6989586621679030494"><span class="hs-identifier hs-var">vars</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030513"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030495"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030496"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030513"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030492"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030513"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030493"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030514"><span class="hs-identifier hs-var">rho</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030513"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030512"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-189"></a><span>    </span><a name="local-6989586621679030500"><a href="#local-6989586621679030500"><span class="hs-identifier">third1</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-identifier">third1</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-identifier">third1</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-identifier">third1</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030503"><a href="#local-6989586621679030503"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679030504"><a href="#local-6989586621679030504"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030503"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030500"><span class="hs-identifier hs-var">third1</span></a><span> </span><a href="#local-6989586621679030504"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-193"></a><span>    </span><a name="local-6989586621679030501"><a href="#local-6989586621679030501"><span class="hs-identifier">third2</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-identifier">third2</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-identifier">third2</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679030505"><a href="#local-6989586621679030505"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030505"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-identifier">third2</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030506"><a href="#local-6989586621679030506"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030507"><a href="#local-6989586621679030507"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030506"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030501"><span class="hs-identifier hs-var">third2</span></a><span> </span><a href="#local-6989586621679030507"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-197"></a><span>    </span><a name="local-6989586621679030502"><a href="#local-6989586621679030502"><span class="hs-identifier">third3</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-identifier">third3</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679030508"><a href="#local-6989586621679030508"><span class="hs-identifier">e</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030508"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-identifier">third3</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679030509"><a href="#local-6989586621679030509"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679030509"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-identifier">third3</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030510"><a href="#local-6989586621679030510"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679030511"><a href="#local-6989586621679030511"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679030510"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679030502"><span class="hs-identifier hs-var">third3</span></a><span> </span><a href="#local-6989586621679030511"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-identifier">typeinfer</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span> </span><a name="local-6989586621679030515"><a href="#local-6989586621679030515"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><a href="#local-6989586621679030515"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-identifier">typeinfer</span><span> </span><a name="local-6989586621679030516"><a href="#local-6989586621679030516"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679030517"><a href="#local-6989586621679030517"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679030518"><a href="#local-6989586621679030518"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030516"><span class="hs-identifier hs-var">vars</span></a><span> </span><a href="#local-6989586621679030517"><span class="hs-identifier hs-var">ctx</span></a><span> </span><a href="#local-6989586621679030518"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-identifier">typeinfer</span><span> </span><a name="local-6989586621679030519"><a href="#local-6989586621679030519"><span class="hs-identifier">vars</span></a></a><span> </span><a name="local-6989586621679030520"><a href="#local-6989586621679030520"><span class="hs-identifier">ctx</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679030521"><a href="#local-6989586621679030521"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679030522"><a href="#local-6989586621679030522"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-207"></a><span>  </span><a name="local-6989586621679030523"><a href="#local-6989586621679030523"><span class="hs-identifier">sigma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#unify"><span class="hs-identifier hs-var">unify</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><a href="#local-6989586621679030522"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-208"></a><span>  </span><a name="local-6989586621679030524"><a href="#local-6989586621679030524"><span class="hs-identifier">tau</span></a></a><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="#local-6989586621679030519"><span class="hs-identifier hs-var">vars</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applyctx"><span class="hs-identifier hs-var">applyctx</span></a><span> </span><a href="#local-6989586621679030523"><span class="hs-identifier hs-var">sigma</span></a><span> </span><a href="#local-6989586621679030520"><span class="hs-identifier hs-var">ctx</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030521"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-209"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030524"><span class="hs-identifier hs-var">tau</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679030523"><span class="hs-identifier hs-var">sigma</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>  </span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Type inference of a lambda expression.</span><span>
</span><a name="line-213"></a><span class="hs-identifier">typeinference</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-214"></a><a name="typeinference"><a href="Stlc.Types.html#typeinference"><span class="hs-identifier">typeinference</span></a></a><span> </span><a name="local-6989586621679030525"><a href="#local-6989586621679030525"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#normalize"><span class="hs-identifier hs-var">normalize</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#typeinfer"><span class="hs-identifier hs-var">typeinfer</span></a><span> </span><a href="Stlc.Types.html#variables"><span class="hs-identifier hs-var">variables</span></a><span> </span><a href="Stlc.Types.html#emptyctx"><span class="hs-identifier hs-var">emptyctx</span></a><span> </span><a href="#local-6989586621679030525"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-- | List of possible variable names.</span><span>
</span><a name="line-217"></a><span class="hs-identifier">typevariableNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-218"></a><a name="typevariableNames"><a href="Stlc.Types.html#typevariableNames"><span class="hs-identifier">typevariableNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">replicateM</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-char">'A'</span><span class="hs-glyph">..</span><span class="hs-char">'Z'</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-comment">-- | Infinite list of variables.</span><span>
</span><a name="line-221"></a><span class="hs-identifier">variables</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Stlc.Types.html#Variable"><span class="hs-identifier hs-type">Variable</span></a><span class="hs-special">]</span><span>
</span><a name="line-222"></a><a name="variables"><a href="Stlc.Types.html#variables"><span class="hs-identifier">variables</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- | Substitutes a set of type variables on a type template for the smaller</span><span>
</span><a name="line-226"></a><span class="hs-comment">-- possible ones.</span><span>
</span><a name="line-227"></a><span class="hs-identifier">normalizeTemplate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><a name="normalizeTemplate"><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier">normalizeTemplate</span></a></a><span> </span><a name="local-6989586621679030526"><a href="#local-6989586621679030526"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679030527"><a href="#local-6989586621679030527"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030528"><a href="#local-6989586621679030528"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679030528"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679030526"><span class="hs-identifier hs-var">sub</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-229"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030526"><span class="hs-identifier hs-var">sub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030527"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>                                    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679030528"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679030527"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679030526"><span class="hs-identifier hs-var">sub</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679030527"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-231"></a><span class="hs-identifier">normalizeTemplate</span><span> </span><a name="local-6989586621679030529"><a href="#local-6989586621679030529"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679030530"><a href="#local-6989586621679030530"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030531"><a href="#local-6989586621679030531"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030532"><a href="#local-6989586621679030532"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030533"><a href="#local-6989586621679030533"><span class="hs-identifier">nsub</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679030534"><a href="#local-6989586621679030534"><span class="hs-identifier">nn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><a href="#local-6989586621679030529"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030530"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679030531"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><a href="#local-6989586621679030533"><span class="hs-identifier hs-var">nsub</span></a><span> </span><a href="#local-6989586621679030534"><span class="hs-identifier hs-var">nn</span></a><span> </span><a href="#local-6989586621679030532"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-233"></a><span class="hs-identifier">normalizeTemplate</span><span> </span><a name="local-6989586621679030535"><a href="#local-6989586621679030535"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679030536"><a href="#local-6989586621679030536"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030537"><a href="#local-6989586621679030537"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030538"><a href="#local-6989586621679030538"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030539"><a href="#local-6989586621679030539"><span class="hs-identifier">nsub</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679030540"><a href="#local-6989586621679030540"><span class="hs-identifier">nn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><a href="#local-6989586621679030535"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030536"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679030537"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><a href="#local-6989586621679030539"><span class="hs-identifier hs-var">nsub</span></a><span> </span><a href="#local-6989586621679030540"><span class="hs-identifier hs-var">nn</span></a><span> </span><a href="#local-6989586621679030538"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-235"></a><span class="hs-identifier">normalizeTemplate</span><span> </span><a name="local-6989586621679030541"><a href="#local-6989586621679030541"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679030542"><a href="#local-6989586621679030542"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030543"><a href="#local-6989586621679030543"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030544"><a href="#local-6989586621679030544"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-236"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679030545"><a href="#local-6989586621679030545"><span class="hs-identifier">nsub</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679030546"><a href="#local-6989586621679030546"><span class="hs-identifier">nn</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><a href="#local-6989586621679030541"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030542"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679030543"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><a href="#local-6989586621679030545"><span class="hs-identifier hs-var">nsub</span></a><span> </span><a href="#local-6989586621679030546"><span class="hs-identifier hs-var">nn</span></a><span> </span><a href="#local-6989586621679030544"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-237"></a><span class="hs-identifier">normalizeTemplate</span><span> </span><a name="local-6989586621679030547"><a href="#local-6989586621679030547"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679030548"><a href="#local-6989586621679030548"><span class="hs-identifier">n</span></a></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030547"><span class="hs-identifier hs-var">sub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030548"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span class="hs-identifier">normalizeTemplate</span><span> </span><a name="local-6989586621679030549"><a href="#local-6989586621679030549"><span class="hs-identifier">sub</span></a></a><span> </span><a name="local-6989586621679030550"><a href="#local-6989586621679030550"><span class="hs-identifier">n</span></a></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679030549"><span class="hs-identifier hs-var">sub</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679030550"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">-- | Applies a set of variable substitutions to a type to normalize it.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">applynormalization</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-242"></a><a name="applynormalization"><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier">applynormalization</span></a></a><span> </span><a name="local-6989586621679030551"><a href="#local-6989586621679030551"><span class="hs-identifier">sub</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030552"><a href="#local-6989586621679030552"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679030552"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679030551"><span class="hs-identifier hs-var">sub</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-243"></a><span>                                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679030553"><a href="#local-6989586621679030553"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030553"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-244"></a><span>                                    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030552"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-245"></a><span class="hs-identifier">applynormalization</span><span> </span><a name="local-6989586621679030554"><a href="#local-6989586621679030554"><span class="hs-identifier">sub</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030555"><a href="#local-6989586621679030555"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030556"><a href="#local-6989586621679030556"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679030554"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030555"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679030554"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030556"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span class="hs-identifier">applynormalization</span><span> </span><a name="local-6989586621679030557"><a href="#local-6989586621679030557"><span class="hs-identifier">sub</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030558"><a href="#local-6989586621679030558"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030559"><a href="#local-6989586621679030559"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679030557"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030558"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679030557"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030559"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span class="hs-identifier">applynormalization</span><span> </span><a name="local-6989586621679030560"><a href="#local-6989586621679030560"><span class="hs-identifier">sub</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030561"><a href="#local-6989586621679030561"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030562"><a href="#local-6989586621679030562"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679030560"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030561"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><a href="#local-6989586621679030560"><span class="hs-identifier hs-var">sub</span></a><span> </span><a href="#local-6989586621679030562"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span class="hs-identifier">applynormalization</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span>
</span><a name="line-249"></a><span class="hs-identifier">applynormalization</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">-- | Normalizes a type, that is, substitutes the set of type variables for</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- the smaller possible ones.</span><span>
</span><a name="line-255"></a><span class="hs-identifier">normalize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-256"></a><a name="normalize"><a href="Stlc.Types.html#normalize"><span class="hs-identifier">normalize</span></a></a><span> </span><a name="local-6989586621679030563"><a href="#local-6989586621679030563"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#applynormalization"><span class="hs-identifier hs-var">applynormalization</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Stlc.Types.html#normalizeTemplate"><span class="hs-identifier hs-var">normalizeTemplate</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679030563"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679030563"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- This is definitely not an easter egg</span><span>
</span><a name="line-262"></a><span class="hs-keyword">newtype</span><span> </span><a name="Top"><a href="Stlc.Types.html#Top"><span class="hs-identifier">Top</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Top"><a href="Stlc.Types.html#Top"><span class="hs-identifier">Top</span></a></a><span> </span><a href="Stlc.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-263"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-type">Top</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-264"></a><span>  </span><a name="local-8214565720323784720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030578"><a href="#local-6989586621679030578"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#typevariableNames"><span class="hs-identifier hs-var">typevariableNames</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679030578"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-265"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030579"><a href="#local-6989586621679030579"><span class="hs-identifier">a</span></a></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&#8486;&#8726;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030579"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&#7484;&quot;</span><span>
</span><a name="line-266"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Arrow"><span class="hs-identifier hs-var">Arrow</span></a><span> </span><a name="local-6989586621679030580"><a href="#local-6989586621679030580"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030581"><a href="#local-6989586621679030581"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;((&#8486;&#8726;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030580"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;) &#8746; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030581"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&#7484;&quot;</span><span>
</span><a name="line-267"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Times"><span class="hs-identifier hs-var">Times</span></a><span> </span><a name="local-6989586621679030582"><a href="#local-6989586621679030582"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030583"><a href="#local-6989586621679030583"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030582"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &#8745; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030583"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Union"><span class="hs-identifier hs-var">Union</span></a><span> </span><a name="local-6989586621679030584"><a href="#local-6989586621679030584"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679030585"><a href="#local-6989586621679030585"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030584"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &#8746; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Stlc.Types.html#showparensT"><span class="hs-identifier hs-var">showparensT</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030585"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#8486;&quot;</span><span>
</span><a name="line-270"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#216;&quot;</span><span>
</span><a name="line-271"></a><span class="hs-identifier">showparensT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-type">Top</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-272"></a><a name="showparensT"><a href="Stlc.Types.html#showparensT"><span class="hs-identifier">showparensT</span></a></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a name="local-6989586621679030576"><a href="#local-6989586621679030576"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Tvar"><span class="hs-identifier hs-var">Tvar</span></a><span> </span><a href="#local-6989586621679030576"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span class="hs-identifier">showparensT</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="Stlc.Types.html#Unitty"><span class="hs-identifier hs-var">Unitty</span></a><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span class="hs-identifier">showparensT</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="Stlc.Types.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span class="hs-identifier">showparensT</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a name="local-6989586621679030577"><a href="#local-6989586621679030577"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><a href="Stlc.Types.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><a href="#local-6989586621679030577"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-276"></a></pre></body></html>