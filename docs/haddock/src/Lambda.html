<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module: Lambda
Description: DeBruijn lambda expressions.
License: GPL-3

This module deals with the parsing, reduction and printing of lambda
expressions using DeBruijn notation. The interpreter uses DeBruijn
notation as an internal representation and as output format. This is because
it is easier to do beta reduction with DeBruijn indexes.
-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lambda</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span class="hs-special">,</span><span> </span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda.html#simplifyAll"><span class="hs-identifier hs-var">simplifyAll</span></a><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda.html#simplifySteps"><span class="hs-identifier hs-var">simplifySteps</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda.html#showReduction"><span class="hs-identifier hs-var">showReduction</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda.html#usestypecons"><span class="hs-identifier hs-var">usestypecons</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Format.html"><span class="hs-identifier">Format</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- DeBruijn Expressions</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- | A lambda expression using DeBruijn indexes.</span><span>
</span><a name="line-26"></a><span class="hs-keyword">data</span><span> </span><a name="Exp"><a href="Lambda.html#Exp"><span class="hs-identifier">Exp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Var"><a href="Lambda.html#Var"><span class="hs-identifier">Var</span></a></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>        </span><span class="hs-comment">-- ^ integer indexing the variable.</span><span>
</span><a name="line-27"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Lambda"><a href="Lambda.html#Lambda"><span class="hs-identifier">Lambda</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>         </span><span class="hs-comment">-- ^ lambda abstraction.</span><span>
</span><a name="line-28"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="App"><a href="Lambda.html#App"><span class="hs-identifier">App</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>        </span><span class="hs-comment">-- ^ function application.</span><span>
</span><a name="line-29"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Pair"><a href="Lambda.html#Pair"><span class="hs-identifier">Pair</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>       </span><span class="hs-comment">-- ^ typed pair of expressions.</span><span>
</span><a name="line-30"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Pi1"><a href="Lambda.html#Pi1"><span class="hs-identifier">Pi1</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>            </span><span class="hs-comment">-- ^ typed first projection.</span><span>
</span><a name="line-31"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Pi2"><a href="Lambda.html#Pi2"><span class="hs-identifier">Pi2</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>            </span><span class="hs-comment">-- ^ typed second projection.</span><span>
</span><a name="line-32"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Inl"><a href="Lambda.html#Inl"><span class="hs-identifier">Inl</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>            </span><span class="hs-comment">-- ^ typed left injection.</span><span>
</span><a name="line-33"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Inr"><a href="Lambda.html#Inr"><span class="hs-identifier">Inr</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>            </span><span class="hs-comment">-- ^ typed right injection.</span><span>
</span><a name="line-34"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Caseof"><a href="Lambda.html#Caseof"><span class="hs-identifier">Caseof</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-comment">-- ^ typed case of.</span><span>
</span><a name="line-35"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Unit"><a href="Lambda.html#Unit"><span class="hs-identifier">Unit</span></a></a><span>               </span><span class="hs-comment">-- ^ typed unit element.</span><span>
</span><a name="line-36"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Abort"><a href="Lambda.html#Abort"><span class="hs-identifier">Abort</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>          </span><span class="hs-comment">-- ^ typed abort derivation.</span><span>
</span><a name="line-37"></a><span>         </span><span class="hs-glyph">|</span><span> </span><a name="Absurd"><a href="Lambda.html#Absurd"><span class="hs-identifier">Absurd</span></a></a><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>         </span><span class="hs-comment">-- ^ typed absurd derivation.</span><span>
</span><a name="line-38"></a><span>         </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-41"></a><span>  </span><a name="local-8214565720323784720"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- | Shows an expression with DeBruijn indexes.</span><span>
</span><a name="line-44"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-45"></a><a name="showexp"><a href="Lambda.html#showexp"><span class="hs-identifier">showexp</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679023723"><a href="#local-6989586621679023723"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679023723"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-46"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679023724"><a href="#local-6989586621679023724"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#955;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023724"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-47"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679023725"><a href="#local-6989586621679023725"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679023726"><a href="#local-6989586621679023726"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023725"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023726"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-48"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679023727"><a href="#local-6989586621679023727"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679023728"><a href="#local-6989586621679023728"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023727"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023728"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-49"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679023729"><a href="#local-6989586621679023729"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;FST &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023729"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-50"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679023730"><a href="#local-6989586621679023730"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;SND &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023730"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-51"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679023731"><a href="#local-6989586621679023731"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;INL &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023731"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-52"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679023732"><a href="#local-6989586621679023732"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;INR &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023732"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-53"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679023733"><a href="#local-6989586621679023733"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679023734"><a href="#local-6989586621679023734"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679023735"><a href="#local-6989586621679023735"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;CASE &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023733"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; OF &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023734"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023735"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-54"></a><span class="hs-identifier">showexp</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;*&quot;</span><span>
</span><a name="line-55"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679023736"><a href="#local-6989586621679023736"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(ABORT &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-56"></a><span class="hs-identifier">showexp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679023737"><a href="#local-6989586621679023737"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(ABSURD &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- | Shows an expression coloring the next reduction.</span><span>
</span><a name="line-59"></a><span class="hs-identifier">showReduction</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-60"></a><a name="showReduction"><a href="Lambda.html#showReduction"><span class="hs-identifier">showReduction</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679023738"><a href="#local-6989586621679023738"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#955;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showReduction"><span class="hs-identifier hs-var">showReduction</span></a><span> </span><a href="#local-6989586621679023738"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-61"></a><span class="hs-identifier">showReduction</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679023739"><a href="#local-6989586621679023739"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679023740"><a href="#local-6989586621679023740"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#betaColor"><span class="hs-identifier hs-var">betaColor</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a href="#local-6989586621679023739"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023740"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span class="hs-identifier">showReduction</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679023741"><a href="#local-6989586621679023741"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679023741"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-63"></a><span class="hs-identifier">showReduction</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679023742"><a href="#local-6989586621679023742"><span class="hs-identifier">rs</span></a></a><span> </span><a name="local-6989586621679023743"><a href="#local-6989586621679023743"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showReduction"><span class="hs-identifier hs-var">showReduction</span></a><span> </span><a href="#local-6989586621679023742"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showReduction"><span class="hs-identifier hs-var">showReduction</span></a><span> </span><a href="#local-6989586621679023743"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-64"></a><span class="hs-identifier">showReduction</span><span> </span><a name="local-6989586621679023744"><a href="#local-6989586621679023744"><span class="hs-identifier">e</span></a></a><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679023744"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | Colors a beta reduction</span><span>
</span><a name="line-68"></a><span class="hs-identifier">betaColor</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-69"></a><a name="betaColor"><a href="Lambda.html#betaColor"><span class="hs-identifier">betaColor</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679023745"><a href="#local-6989586621679023745"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679023746"><a href="#local-6989586621679023746"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-71"></a><span>  </span><a href="Format.html#formatSubs1"><span class="hs-identifier hs-var">formatSubs1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;&#955;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Format.html#formatFormula"><span class="hs-identifier hs-var">formatFormula</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-72"></a><span>  </span><a href="Lambda.html#indexColor"><span class="hs-identifier hs-var">indexColor</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679023745"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-74"></a><span>  </span><a href="Format.html#formatSubs2"><span class="hs-identifier hs-var">formatSubs2</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#showexp"><span class="hs-identifier hs-var">showexp</span></a><span> </span><a href="#local-6989586621679023746"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Format.html#formatFormula"><span class="hs-identifier hs-var">formatFormula</span></a><span>
</span><a name="line-75"></a><span>  </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-76"></a><span class="hs-identifier">betaColor</span><span> </span><a name="local-6989586621679023747"><a href="#local-6989586621679023747"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679023747"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Colors all the appearances of a given index</span><span>
</span><a name="line-79"></a><span class="hs-identifier">indexColor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-80"></a><a name="indexColor"><a href="Lambda.html#indexColor"><span class="hs-identifier">indexColor</span></a></a><span> </span><a name="local-6989586621679023748"><a href="#local-6989586621679023748"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679023749"><a href="#local-6989586621679023749"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&#955;&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#indexColor"><span class="hs-identifier hs-var">indexColor</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679023748"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023749"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-81"></a><span class="hs-identifier">indexColor</span><span> </span><a name="local-6989586621679024205"><a href="#local-6989586621679024205"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024206"><a href="#local-6989586621679024206"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024207"><a href="#local-6989586621679024207"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;(&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#indexColor"><span class="hs-identifier hs-var">indexColor</span></a><span> </span><a href="#local-6989586621679024205"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024206"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Lambda.html#indexColor"><span class="hs-identifier hs-var">indexColor</span></a><span> </span><a href="#local-6989586621679024205"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024207"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;)&quot;</span><span>
</span><a name="line-82"></a><span class="hs-identifier">indexColor</span><span> </span><a name="local-6989586621679024208"><a href="#local-6989586621679024208"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679024209"><a href="#local-6989586621679024209"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024208"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679024209"><span class="hs-identifier hs-var">m</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Format.html#formatSubs1"><span class="hs-identifier hs-var">formatSubs1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679024209"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Format.html#formatFormula"><span class="hs-identifier hs-var">formatFormula</span></a><span>
</span><a name="line-84"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679024209"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-85"></a><span class="hs-identifier">indexColor</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679024210"><a href="#local-6989586621679024210"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679024210"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">-- Reductions of lambda expressions.</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-comment">-- | Applies repeated simplification to the expression until it stabilizes and</span><span>
</span><a name="line-92"></a><span class="hs-comment">--   returns the final simplified expression.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- &gt;&gt;&gt; simplifyAll $ App (Lambda (Var 1)) (Lambda (Var 1))</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- &#955;1</span><span>
</span><a name="line-96"></a><span class="hs-comment">--</span><span>
</span><a name="line-97"></a><span class="hs-identifier">simplifyAll</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-98"></a><a name="simplifyAll"><a href="Lambda.html#simplifyAll"><span class="hs-identifier">simplifyAll</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Lambda.html#simplifySteps"><span class="hs-identifier hs-var">simplifySteps</span></a><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- | Applies repeated simplification to the expression until it stabilizes and</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- returns all the intermediate results.</span><span>
</span><a name="line-102"></a><span class="hs-comment">--</span><span>
</span><a name="line-103"></a><span class="hs-comment">-- &gt;&gt;&gt; simplifySteps $ App (Lambda (Var 1)) (Lambda (Var 1))</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- [(&#955;1 &#955;1),&#955;1]</span><span>
</span><a name="line-105"></a><span class="hs-comment">--</span><span>
</span><a name="line-106"></a><span class="hs-identifier">simplifySteps</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">]</span><span>
</span><a name="line-107"></a><a name="simplifySteps"><a href="Lambda.html#simplifySteps"><span class="hs-identifier">simplifySteps</span></a></a><span> </span><a name="local-6989586621679024211"><a href="#local-6989586621679024211"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024211"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679024212"><span class="hs-identifier hs-var">s</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679024211"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024211"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Lambda.html#simplifySteps"><span class="hs-identifier hs-var">simplifySteps</span></a><span> </span><a href="#local-6989586621679024212"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679024212"><a href="#local-6989586621679024212"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024211"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- | Simplifies the expression recursively.</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- Applies only one parallel beta reduction at each step.</span><span>
</span><a name="line-114"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-115"></a><a name="simplify"><a href="Lambda.html#simplify"><span class="hs-identifier">simplify</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024213"><a href="#local-6989586621679024213"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024213"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024214"><a href="#local-6989586621679024214"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679024215"><a href="#local-6989586621679024215"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#betared"><span class="hs-identifier hs-var">betared</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a href="#local-6989586621679024214"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024215"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679024216"><a href="#local-6989586621679024216"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679024217"><a href="#local-6989586621679024217"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621679024216"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024217"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024218"><a href="#local-6989586621679024218"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024219"><a href="#local-6989586621679024219"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679024220"><a href="#local-6989586621679024220"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679024218"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679024219"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024220"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024221"><a href="#local-6989586621679024221"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024222"><a href="#local-6989586621679024222"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024221"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024222"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679024223"><a href="#local-6989586621679024223"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621679024223"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-121"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679024224"><a href="#local-6989586621679024224"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024225"><a href="#local-6989586621679024225"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024224"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024225"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679024226"><a href="#local-6989586621679024226"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024226"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-123"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679024227"><a href="#local-6989586621679024227"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024227"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679024228"><a href="#local-6989586621679024228"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024228"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-125"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679024229"><a href="#local-6989586621679024229"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024229"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679024230"><a href="#local-6989586621679024230"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024230"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679024231"><a href="#local-6989586621679024231"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024231"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679024232"><a href="#local-6989586621679024232"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679024233"><a href="#local-6989586621679024233"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679024232"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-129"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679024234"><a href="#local-6989586621679024234"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679024235"><a href="#local-6989586621679024235"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a href="#local-6989586621679024235"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679024234"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-130"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679024236"><a href="#local-6989586621679024236"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024237"><a href="#local-6989586621679024237"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679024238"><a href="#local-6989586621679024238"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024236"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024237"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024238"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span class="hs-identifier">simplify</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>               </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>
</span><a name="line-132"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679024239"><a href="#local-6989586621679024239"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024239"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679024240"><a href="#local-6989586621679024240"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span> </span><a href="#local-6989586621679024240"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-- | Applies beta-reduction to a function application.</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- Leaves the rest of the operations untouched.</span><span>
</span><a name="line-137"></a><span class="hs-identifier">betared</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-138"></a><a name="betared"><a href="Lambda.html#betared"><span class="hs-identifier">betared</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024241"><a href="#local-6989586621679024241"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679024242"><a href="#local-6989586621679024242"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679024242"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024241"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-139"></a><span class="hs-identifier">betared</span><span> </span><a name="local-6989586621679024243"><a href="#local-6989586621679024243"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024243"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- | Substitutes an index for a lambda expression</span><span>
</span><a name="line-142"></a><span class="hs-identifier">substitute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-comment">-- ^ deBruijn index of the desired target</span><span>
</span><a name="line-143"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>     </span><span class="hs-comment">-- ^ replacement for the index</span><span>
</span><a name="line-144"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>     </span><span class="hs-comment">-- ^ initial expression</span><span>
</span><a name="line-145"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-146"></a><a name="substitute"><a href="Lambda.html#substitute"><span class="hs-identifier">substitute</span></a></a><span> </span><a name="local-6989586621679024244"><a href="#local-6989586621679024244"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024245"><a href="#local-6989586621679024245"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024246"><a href="#local-6989586621679024246"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679024244"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679024245"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024246"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024247"><a href="#local-6989586621679024247"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024248"><a href="#local-6989586621679024248"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024249"><a href="#local-6989586621679024249"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024250"><a href="#local-6989586621679024250"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024247"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024248"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024249"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024247"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024248"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024250"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024251"><a href="#local-6989586621679024251"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024252"><a href="#local-6989586621679024252"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679024253"><a href="#local-6989586621679024253"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024254"><a href="#local-6989586621679024254"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024251"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024252"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024253"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024251"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024252"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024254"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024255"><a href="#local-6989586621679024255"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024256"><a href="#local-6989586621679024256"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679024257"><a href="#local-6989586621679024257"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024255"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024256"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024257"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024258"><a href="#local-6989586621679024258"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024259"><a href="#local-6989586621679024259"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679024260"><a href="#local-6989586621679024260"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024258"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024259"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024260"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024261"><a href="#local-6989586621679024261"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024262"><a href="#local-6989586621679024262"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679024263"><a href="#local-6989586621679024263"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024261"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024262"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024263"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024264"><a href="#local-6989586621679024264"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024265"><a href="#local-6989586621679024265"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679024266"><a href="#local-6989586621679024266"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024264"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024265"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024266"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024267"><a href="#local-6989586621679024267"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024268"><a href="#local-6989586621679024268"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679024269"><a href="#local-6989586621679024269"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024270"><a href="#local-6989586621679024270"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679024271"><a href="#local-6989586621679024271"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024267"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024268"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024269"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024267"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024268"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024270"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024267"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024268"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024271"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span class="hs-identifier">substitute</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>
</span><a name="line-155"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024272"><a href="#local-6989586621679024272"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024273"><a href="#local-6989586621679024273"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679024274"><a href="#local-6989586621679024274"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024272"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024273"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024274"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024275"><a href="#local-6989586621679024275"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024276"><a href="#local-6989586621679024276"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679024277"><a href="#local-6989586621679024277"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#substitute"><span class="hs-identifier hs-var">substitute</span></a><span> </span><a href="#local-6989586621679024275"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024276"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679024277"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span class="hs-identifier">substitute</span><span> </span><a name="local-6989586621679024278"><a href="#local-6989586621679024278"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679024279"><a href="#local-6989586621679024279"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679024280"><a href="#local-6989586621679024280"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>  </span><span class="hs-comment">-- The lambda is replaced directly</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024278"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679024280"><span class="hs-identifier hs-var">m</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024279"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-160"></a><span>  </span><span class="hs-comment">-- A more exterior lambda decreases a number</span><span>
</span><a name="line-161"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024278"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span>  </span><a href="#local-6989586621679024280"><span class="hs-identifier hs-var">m</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024280"><span class="hs-identifier hs-var">m</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-comment">-- An unrelated variable remains untouched</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621679024280"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><span class="hs-comment">-- | Increments free variables assuming they are bind to an</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- external lambda. This is done to substitute them correctly in</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- internal expressions.</span><span>
</span><a name="line-168"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span>
</span><a name="line-169"></a><a name="incrementFreeVars"><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier">incrementFreeVars</span></a></a><span> </span><a name="local-6989586621679024281"><a href="#local-6989586621679024281"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024282"><a href="#local-6989586621679024282"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024283"><a href="#local-6989586621679024283"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024281"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024282"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024281"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024283"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024284"><a href="#local-6989586621679024284"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024285"><a href="#local-6989586621679024285"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679024284"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024285"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024286"><a href="#local-6989586621679024286"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679024287"><a href="#local-6989586621679024287"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024287"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679024286"><span class="hs-identifier hs-var">n</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">succ</span><span> </span><a href="#local-6989586621679024287"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a href="#local-6989586621679024287"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-174"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024288"><a href="#local-6989586621679024288"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679024289"><a href="#local-6989586621679024289"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024290"><a href="#local-6989586621679024290"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024288"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024289"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024288"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024290"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-175"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024291"><a href="#local-6989586621679024291"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679024292"><a href="#local-6989586621679024292"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024291"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024292"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-176"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024293"><a href="#local-6989586621679024293"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679024294"><a href="#local-6989586621679024294"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024293"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024294"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024295"><a href="#local-6989586621679024295"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679024296"><a href="#local-6989586621679024296"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024295"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024296"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024297"><a href="#local-6989586621679024297"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679024298"><a href="#local-6989586621679024298"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024297"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024298"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024299"><a href="#local-6989586621679024299"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679024300"><a href="#local-6989586621679024300"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024301"><a href="#local-6989586621679024301"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679024302"><a href="#local-6989586621679024302"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024299"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024300"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024299"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024301"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024299"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024302"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>
</span><a name="line-181"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024303"><a href="#local-6989586621679024303"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679024304"><a href="#local-6989586621679024304"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024303"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024304"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span class="hs-identifier">incrementFreeVars</span><span> </span><a name="local-6989586621679024305"><a href="#local-6989586621679024305"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679024306"><a href="#local-6989586621679024306"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#incrementFreeVars"><span class="hs-identifier hs-var">incrementFreeVars</span></a><span> </span><a href="#local-6989586621679024305"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024306"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | Determines if the given variable is free on the expression.</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- freein :: Integer -&gt; Exp -&gt; Bool</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- freein n (Var m)    = n == m</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- freein n (Lambda e) = freein (succ n) e</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- freein n (App u v)  = (freein n u) &amp;&amp; (freein n v)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | Returns true if the expression has at least one type constructor.</span><span>
</span><a name="line-192"></a><span class="hs-identifier">usestypecons</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-193"></a><a name="usestypecons"><a href="Lambda.html#usestypecons"><span class="hs-identifier">usestypecons</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-194"></a><span class="hs-identifier">usestypecons</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024307"><a href="#local-6989586621679024307"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024308"><a href="#local-6989586621679024308"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#usestypecons"><span class="hs-identifier hs-var">usestypecons</span></a><span> </span><a href="#local-6989586621679024307"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Lambda.html#usestypecons"><span class="hs-identifier hs-var">usestypecons</span></a><span> </span><a href="#local-6989586621679024308"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-195"></a><span class="hs-identifier">usestypecons</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024309"><a href="#local-6989586621679024309"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#usestypecons"><span class="hs-identifier hs-var">usestypecons</span></a><span> </span><a href="#local-6989586621679024309"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-196"></a><span class="hs-identifier">usestypecons</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | Returns true if the expression contains open undefined variables.</span><span>
</span><a name="line-200"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Lambda.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-201"></a><a name="isOpenExp"><a href="Lambda.html#isOpenExp"><span class="hs-identifier">isOpenExp</span></a></a><span> </span><span class="hs-special">(</span><a href="Lambda.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679024310"><a href="#local-6989586621679024310"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024310"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-202"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#App"><span class="hs-identifier hs-var">App</span></a><span> </span><a name="local-6989586621679024311"><a href="#local-6989586621679024311"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024312"><a href="#local-6989586621679024312"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024311"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024312"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-203"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a><span> </span><a name="local-6989586621679024313"><a href="#local-6989586621679024313"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024313"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-204"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679024314"><a href="#local-6989586621679024314"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024315"><a href="#local-6989586621679024315"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024314"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024315"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-205"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi1"><span class="hs-identifier hs-var">Pi1</span></a><span> </span><a name="local-6989586621679024316"><a href="#local-6989586621679024316"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024316"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-206"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Pi2"><span class="hs-identifier hs-var">Pi2</span></a><span> </span><a name="local-6989586621679024317"><a href="#local-6989586621679024317"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024317"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-207"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inl"><span class="hs-identifier hs-var">Inl</span></a><span> </span><a name="local-6989586621679024318"><a href="#local-6989586621679024318"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024318"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-208"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Inr"><span class="hs-identifier hs-var">Inr</span></a><span> </span><a name="local-6989586621679024319"><a href="#local-6989586621679024319"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024319"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-209"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Caseof"><span class="hs-identifier hs-var">Caseof</span></a><span> </span><a name="local-6989586621679024320"><a href="#local-6989586621679024320"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024321"><a href="#local-6989586621679024321"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679024322"><a href="#local-6989586621679024322"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024320"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024321"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024322"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-210"></a><span class="hs-identifier">isOpenExp</span><span> </span><a href="Lambda.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-211"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Abort"><span class="hs-identifier hs-var">Abort</span></a><span> </span><a name="local-6989586621679024323"><a href="#local-6989586621679024323"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024323"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-212"></a><span class="hs-identifier">isOpenExp</span><span> </span><span class="hs-special">(</span><a href="Lambda.html#Absurd"><span class="hs-identifier hs-var">Absurd</span></a><span> </span><a name="local-6989586621679024324"><a href="#local-6989586621679024324"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Lambda.html#isOpenExp"><span class="hs-identifier hs-var">isOpenExp</span></a><span> </span><a href="#local-6989586621679024324"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-213"></a></pre></body></html>